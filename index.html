<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My GitHub Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <!-- âœ… Fixed Firebase scripts: use compat versions -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background-color: #f9f9f9;
      color: #333;
    }

    #errorDisplay {
      background: #ffdddd;
      color: #900;
      padding: 10px;
      display: none;
      text-align: center;
    }

    header {
      background-color: #007acc;
      color: white;
      padding: 40px 20px;
      text-align: center;
    }

    nav a {
      margin: 0 15px;
      text-decoration: none;
      color: white;
      font-weight: bold;
    }

    .page-content {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 40px;
      padding: 40px 5%;
    }

    .left-column,
    .right-column {
      display: flex;
      flex-direction: column;
      gap: 30px;
    }

    .left-column {
      flex: 1;
      max-width: 500px;
    }

    .right-column {
      flex: 1.5;
      max-width: 900px;
    }

    section {
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      padding: 20px;
      position: relative;
    }

    h2 {
      border-bottom: 2px solid #007acc;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    input[type="text"], textarea {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1em;
    }

    input[type="file"] {
      padding: 5px;
    }

    button {
      padding: 10px 20px;
      background-color: #007acc;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 1em;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #005fa3;
    }

    #postsContainer {
      max-height: 500px;
      overflow-y: auto;
      padding-right: 10px;
    }

    .post {
      margin-top: 20px;
      border-top: 1px solid #eee;
      padding-top: 15px;
      position: relative;
    }

    .post img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      margin-top: 10px;
    }

    .timestamp {
      font-size: 0.85em;
      color: #888;
      margin-top: 5px;
    }

    .delete-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      font-size: 1.2em;
      cursor: pointer;
      color: #e74c3c;
    }

    .delete-btn:hover {
      color: #c0392b;
    }

    .comments {
      margin-top: 15px;
      padding-top: 10px;
      border-top: 1px solid #ddd;
    }

    footer {
      text-align: center;
      padding: 40px 10px;
      font-size: 0.9em;
      color: #777;
      border-top: 1px solid #ccc;
      margin-top: 40px;
    }

    @media screen and (max-width: 900px) {
      .page-content {
        flex-direction: column;
        align-items: center;
      }

      .left-column, .right-column {
        max-width: 90%;
        width: 100%;
      }
    }
  </style>
</head>
<body>

  <div id="errorDisplay"></div>

  <header>
    <h1>Welcome to My GitHub Page</h1>
    <nav>
      <a href="#about">About</a>
      <a href="#projects">Projects</a>
      <a href="#post">Post</a>
    </nav>
  </header>

  <div class="page-content">
    <div class="left-column">
      <section id="about">
        <h2>About Me</h2>
        <p>Hello! I'm a developer passionate about open-source, clean code, and creative UI design.</p>
      </section>

      <section id="projects">
        <h2>Projects</h2>
        <ul></ul>
      </section>
    </div>

    <div class="right-column">
      <section id="post">
        <h2>Create a Post</h2>
        <form id="postForm">
          <input type="text" id="postTitle" placeholder="Post Title" required>
          <textarea id="postContent" rows="5" placeholder="Write something..." required></textarea>
          
          <!-- âœ… Accessible file input -->
          <label for="postImage">Attach an image (optional):</label>
          <input type="file" id="postImage" accept="image/*">

          <button type="submit">Publish</button>
        </form>
        <div id="postsContainer"></div>
      </section>
    </div>
  </div>

  <footer>
    &copy; 2025 Henry Park â€“ Built with GitHub Pages
  </footer>

  <script>
Â Â const firebaseConfig = {
Â Â Â Â apiKey: "AIzaSyCraxKhubAnCTGHqKuCoKRWK8tTtzANGoA",
Â Â Â Â authDomain: "githubpage-8c5c3.firebaseapp.com",
Â Â Â Â projectId: "githubpage-8c5c3",
Â Â Â Â storageBucket: "githubpage-8c5c3.appspot.com",
Â Â Â Â messagingSenderId: "142580769287",
Â Â Â Â appId: "1:142580769287:web:4fdbd7caa1e2b41174c0a2"
Â Â };

Â Â firebase.initializeApp(firebaseConfig);
Â Â const db = firebase.firestore();

Â Â const form = document.getElementById('postForm');
Â Â const postsContainer = document.getElementById('postsContainer');

Â Â function showError(message) {
Â Â Â Â const errorDiv = document.getElementById('errorDisplay');
Â Â Â Â errorDiv.textContent = "âš ï¸ " + message;
Â Â Â Â errorDiv.style.display = 'block';
Â Â }

Â Â async function loadPosts() {
Â Â Â Â try {
Â Â Â Â Â Â const snapshot = await db.collection('posts').orderBy('timestamp', 'desc').get();
Â Â Â Â Â Â snapshot.forEach(doc => {
Â Â Â Â Â Â Â Â const post = doc.data();
Â Â Â Â Â Â Â Â post.id = doc.id;
Â Â Â Â Â Â Â Â renderPost(post);
Â Â Â Â Â Â });
Â Â Â Â } catch (error) {
Â Â Â Â Â Â showError("Error loading posts: " + error.message);
Â Â Â Â }
Â Â }

Â Â window.addEventListener('DOMContentLoaded', () => {
Â Â Â Â loadPosts();
Â Â Â Â addRandomProject(); // âœ… ëœë¤ í”„ë¡œì íŠ¸ ì¶”ê°€ ì‹¤í–‰
Â Â });

Â Â // âœ… ëœë¤ í”„ë¡œì íŠ¸ ì¶”ê°€ í•¨ìˆ˜
Â Â function addRandomProject() {
Â Â Â Â const projects = [
Â Â Â Â Â Â { name: "Example Project", link: "https://example.com/weather", desc: "hi" }
Â Â Â Â ];
Â Â Â Â const randomProject = projects[Math.floor(Math.random() * projects.length)];
Â Â Â Â const projectList = document.querySelector("#projects ul");
Â Â Â Â const li = document.createElement("li");
Â Â Â Â li.innerHTML = `<a href="${randomProject.link}" target="_blank"><strong>${randomProject.name}</strong></a> - ${randomProject.desc}`;
Â Â Â Â projectList.appendChild(li);
Â Â }

Â Â form.addEventListener('submit', async function(event) {
Â Â Â Â event.preventDefault();

Â Â Â Â // âœ… ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì¶”ê°€
Â Â Â Â const password = prompt("ğŸ”’ Enter password to publish:");
Â Â Â Â if (password !== "qkrtlgn121206") {
Â Â Â Â Â Â showError("âŒ Incorrect password. Post not published.");
Â Â Â Â Â Â return;
Â Â Â Â }

Â Â Â Â const title = document.getElementById('postTitle').value.trim();
Â Â Â Â const content = document.getElementById('postContent').value.trim();
Â Â Â Â const imageInput = document.getElementById('postImage');
Â Â Â Â const time = new Date().toLocaleString();

Â Â Â Â if (!title || !content) {
Â Â Â Â Â Â showError("Please fill in both title and content.");
Â Â Â Â Â Â return;
Â Â Â Â }

Â Â Â Â const newPost = {
Â Â Â Â Â Â title,
Â Â Â Â Â Â content,
Â Â Â Â Â Â timestamp: time,
Â Â Â Â Â Â image: '',
Â Â Â Â Â Â comments: []
Â Â Â Â };

Â Â Â Â try {
Â Â Â Â Â Â if (imageInput.files && imageInput.files[0]) {
Â Â Â Â Â Â Â Â const reader = new FileReader();
Â Â Â Â Â Â Â Â reader.onload = async function(e) {
Â Â Â Â Â Â Â Â Â Â newPost.image = e.target.result;
Â Â Â Â Â Â Â Â Â Â const docRef = await db.collection('posts').add(newPost);
Â Â Â Â Â Â Â Â Â Â newPost.id = docRef.id;
Â Â Â Â Â Â Â Â Â Â renderPost(newPost);
Â Â Â Â Â Â Â Â };
Â Â Â Â Â Â Â Â reader.readAsDataURL(imageInput.files[0]);
Â Â Â Â Â Â } else {
Â Â Â Â Â Â Â Â const docRef = await db.collection('posts').add(newPost);
Â Â Â Â Â Â Â Â newPost.id = docRef.id;
Â Â Â Â Â Â Â Â renderPost(newPost);
Â Â Â Â Â Â }
Â Â Â Â } catch (error) {
Â Â Â Â Â Â showError("Error publishing post: " + error.message);
Â Â Â Â }

Â Â Â Â form.reset();
Â Â });

Â Â async function deletePost(postId) {
Â Â Â Â try {
Â Â Â Â Â Â await db.collection('posts').doc(postId).delete();
Â Â Â Â } catch (error) {
Â Â Â Â Â Â showError("Error deleting post: " + error.message);
Â Â Â Â }
Â Â }

Â Â function renderPost(post) {
Â Â Â Â const postDiv = document.createElement('div');
Â Â Â Â postDiv.className = 'post';

Â Â Â Â const titleEl = document.createElement('h3');
Â Â Â Â titleEl.textContent = post.title;

Â Â Â Â const contentEl = document.createElement('p');
Â Â Â Â contentEl.textContent = post.content;

Â Â Â Â const timestampEl = document.createElement('div');
Â Â Â Â timestampEl.className = 'timestamp';
Â Â Â Â timestampEl.textContent = `Posted on ${post.timestamp}`;

Â Â Â Â const deleteBtn = document.createElement('button');
Â Â Â Â deleteBtn.className = 'delete-btn';
Â Â Â Â deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
Â Â Â Â deleteBtn.onclick = () => {
Â Â Â Â Â Â const confirmDelete = confirm("âš ï¸ Are you sure you want to delete this post?");
Â Â Â Â Â Â if (confirmDelete) {
Â Â Â Â Â Â Â Â postDiv.remove();
Â Â Â Â Â Â Â Â deletePost(post.id);
Â Â Â Â Â Â }
Â Â Â Â };

Â Â Â Â postDiv.appendChild(deleteBtn);
Â Â Â Â postDiv.appendChild(titleEl);
Â Â Â Â postDiv.appendChild(contentEl);

Â Â Â Â if (post.image) {
Â Â Â Â Â Â const img = document.createElement('img');
Â Â Â Â Â Â img.src = post.image;
Â Â Â Â Â Â postDiv.appendChild(img);
Â Â Â Â }

Â Â Â Â postDiv.appendChild(timestampEl);

Â Â Â Â const commentsContainer = document.createElement('div');
Â Â Â Â commentsContainer.className = 'comments';

Â Â Â Â const commentsList = document.createElement('ul');
Â Â Â Â commentsList.style.paddingLeft = '20px';

Â Â Â Â if (post.comments && post.comments.length > 0) {
Â Â Â Â Â Â post.comments.forEach(comment => {
Â Â Â Â Â Â Â Â const li = document.createElement('li');
Â Â Â Â Â Â Â Â li.textContent = comment;
Â Â Â Â Â Â Â Â commentsList.appendChild(li);
Â Â Â Â Â Â });
Â Â Â Â }

Â Â Â Â const commentForm = document.createElement('form');
Â Â Â Â commentForm.style.marginTop = '10px';
Â Â Â Â commentForm.innerHTML = `
Â Â Â Â Â Â <input type="text" placeholder="Add a comment..." required style="width: 70%; padding: 5px; margin-right: 5px;">
Â Â Â Â Â Â <button type="submit" style="padding: 5px 10px;">Post</button>
Â Â Â Â `;

Â Â Â Â commentForm.addEventListener('submit', async (e) => {
Â Â Â Â Â Â e.preventDefault();
Â Â Â Â Â Â const input = commentForm.querySelector('input');
Â Â Â Â Â Â const comment = input.value.trim();
Â Â Â Â Â Â if (comment) {
Â Â Â Â Â Â Â Â const li = document.createElement('li');
Â Â Â Â Â Â Â Â li.textContent = comment;
Â Â Â Â Â Â Â Â commentsList.appendChild(li);
Â Â Â Â Â Â Â Â input.value = '';

Â Â Â Â Â Â Â Â try {
Â Â Â Â Â Â Â Â Â Â const postRef = db.collection('posts').doc(post.id);
Â Â Â Â Â Â Â Â Â Â const doc = await postRef.get();
Â Â Â Â Â Â Â Â Â Â const currentComments = doc.exists ? doc.data().comments || [] : [];
Â Â Â Â Â Â Â Â Â Â currentComments.push(comment);
Â Â Â Â Â Â Â Â Â Â await postRef.update({ comments: currentComments });
Â Â Â Â Â Â Â Â } catch (error) {
Â Â Â Â Â Â Â Â Â Â showError("Error saving comment: " + error.message);
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }
Â Â Â Â });

Â Â Â Â commentsContainer.appendChild(commentsList);
Â Â Â Â commentsContainer.appendChild(commentForm);
Â Â Â Â postDiv.appendChild(commentsContainer);

Â Â Â Â postsContainer.prepend(postDiv);
Â Â }
</script>
</body>
</html>
